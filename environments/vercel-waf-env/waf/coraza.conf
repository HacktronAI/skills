# Coraza WAF Configuration for CTF Challenge

SecRuleEngine On

# Request body handling
SecRequestBodyAccess On
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 131072

# Response body handling
SecResponseBodyAccess Off

# Debug logging
SecDebugLogLevel 4

# === PROTECTION RULES ===

# Rule 1008: Block Prototype Pollution patterns
# This rule blocks :constructor, __proto__, etc.
SecRule REQUEST_BODY|ARGS|ARGS_NAMES "@rx (?:__proto__|:constructor|\.constructor|prototype\[)" \
    "id:1008,phase:2,deny,status:403,msg:'Prototype Pollution Attempt',tag:'CVE-2025-XXXXX',severity:CRITICAL"
